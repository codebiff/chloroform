<table class="table table-bordered table-striped message">
    <tr class="table-info <%= read_status(message) %>">
      <td colspan="2">
        Received: <%= message.created_at.strftime(current_user.config.date_format) %> at <%= message.created_at.strftime(current_user.config.time_format) %>

        <%= link_to raw('<i class="icon-trash"></i>'), message_delete_url(:id => message.id.to_s), :title => "Delete this message", :class => "btn btn-mini pull-right delete-message" %>

        <% if message.read %>
          <%= link_to raw('<i class="icon-eye-close"></i>'), message_toggle_read_url(:id => message.id.to_s), :title => "Mark as unread", :class => "btn btn-mini pull-right" %>
        <% else %>
         <%= link_to raw('<i class="icon-eye-open"></i>'), message_toggle_read_url(:id => message.id.to_s), :title => "Mark as read", :class => "btn btn-mini pull-right" %>
        <% end %>

      </td>
    </tr>

  <% JSON.parse(message.data).each do |k,v| %>

      <tr>
        <td class="field" width="25%"><%= k -%></td>
        <td><%= v -%></td>
      </tr>

  <% end %>

</table>